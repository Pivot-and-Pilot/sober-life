(function($) {
  /*
  *  render_map
  *
  *  This function will render a Google Map onto the selected jQuery element
  *
  *  @type	function
  *  @date	8/11/2013
  *  @since	4.3.0
  *
  *  @param	$el (jQuery element)
  *  @return	n/a
  */

  function render_map($el) {
    // var
    var $markers = $el.find('.marker');

    // vars
    var args = {
      zoom: 16,
      center: new google.maps.LatLng(0, 0),
      mapTypeId: google.maps.MapTypeId.ROADMAP,
      mapTypeControl: false,
      scaleControl: false,
      scrollwheel: false,
      navigationControl: false,
      streetViewControl: false
    };

    // create map
    var map = new google.maps.Map($el[0], args);

    // add a markers reference
    map.markers = [];

    // add markers
    $markers.each(function() {
      add_marker($(this), map);
    });

    // center map
    center_map(map);
  }

  /*
  *  add_marker
  *
  *  This function will add a marker to the selected Google Map
  *
  *  @type	function
  *  @date	8/11/2013
  *  @since	4.3.0
  *
  *  @param	$marker (jQuery element)
  *  @param	map (Google Map object)
  *  @return	n/a
  */

  function add_marker($marker, map) {
    // var
    var latlng = new google.maps.LatLng(
      $marker.attr('data-lat'),
      $marker.attr('data-lng')
    );

    var template = [
      '<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 128.78 152.1"><defs><style>.cls-1{fill:#80ff73;}</style></defs>',
      '<title>SBL_arrow</title><path class="cls-1" d="M125.78,2.74a2.57,2.57,0,0,1-1-.34C122,1.19,118.87,1.2,115.92.55a4.26,4.26,0,0,0-3.16.14c-3.4,1.94-7.34,2.74-10.67,4.86h0A10.3,10.3,0,0,0,98.22,8,7.76,7.76,0,0,0,96.67,9C92.35,13.73,87.56,18,83.5,23c-3.1,3.83-6,7.75-8.91,11.75-2.6,1.29-3.7,3.77-4.86,6.19l.2.14h0l-.2-.14c-.53.6-1.26,1.06-1.43,1.93v0c-.25.06-.41.18-.34.47a.39.39,0,0,0-.17.41c-1.33.62-1.67,2.16-2.78,3l-1,1.5Q58.67,56,53.36,63.7A3.53,3.53,0,0,0,52,65.88a9.05,9.05,0,0,1-2.66,5.56c-1,.88-.17,1.72,1.07,1.86.63,2.33-1.73,2.74-2.62,4.09-1.23-.6-1.93,1-3.08.72-.75,3.13-2.82,5.52-4.39,8.2-.21.37-1.29,1.28-.11,1.71A1.37,1.37,0,0,0,42,87c0-.29.34-.54.41-.84.42-1.76,1-.84,1.65-.14,0,.42,0,.84,0,1.25a.23.23,0,0,0-.19.3.64.64,0,0,0-.29.81c-.1.21-.19.42-.28.63h0c-1.19,1.83-3.34,3.08-3.88,5.21-.72,2.8-1.09,5.66-3.47,7.69a.92.92,0,0,0-.3.63c.37,2.51-1.94,4.19-2,6.57,0,.44-.41.65-.84.73a3,3,0,0,0-2.31,2.62c-.92,3.72-1.81,7.45-2.7,11.18-.25.79-.65,1.57-.08,2.39,0,.27,0,.55,0,.82a3.28,3.28,0,0,0-1.7,2.67c0,1.18.34,2.84-.76,3.11-1.27.32-.72-1.82-1.68-2.41l0-1.71c0-.51.35-1-.17-1.5-.16-2.61-.31-5.21-.47-7.82,0,0,.13-.09.12-.11a1.6,1.6,0,0,0-.13-.3v0a13.45,13.45,0,0,0,0-4.34c1.56-.35.84-1.52.87-2.42,0-.32,0-.64,0-1l0-1v-1l.1-1a.39.39,0,0,0-.14-.23.39.39,0,0,1,.14.23c0-.32.05-.64.08-1,.42-.45.2-1,.17-1.48l.62-7.22c.68-5.69,1.27-11.39,2.33-17,.75-4,1.45-8,.12-12a.49.49,0,0,0-.4-.58l-.42-.72C23.43,67,20.69,67.7,18,69l-1.42.31a5.15,5.15,0,0,0-6.07,3.29A17.37,17.37,0,0,1,8.33,76.2c-1.43,2.12-4.1,3.61-3.84,6.7,0,.18.1.37.16.56h0l-.15-.56c-.42.19-.91.33-.9.93,0,2-.8,3.88-.47,5.88,0,.16,0,.31,0,.47-.87,9.34-3.18,18.55-2.8,28,.16,3.88-.09,7.82.85,11.65a30.62,30.62,0,0,0,.09,4.07c.47,3.13-.16,6.63,2.76,9-.21,1.73,1.06,2.45,2.29,3,1.82.77,3.75,1.26,5.62,1.92,4.38,1.57,9.37.84,13.46,3.62.67.46,2.47.49,2.73.08,1.5-2.35,4-1.05,5.87-1.79a11.66,11.66,0,0,0,3.39-1.58c2.48-.13,4.5-1.62,6.77-2.36a1.3,1.3,0,0,0,1.13-.48l0,0,0-.07h0a.19.19,0,0,0,.28-.15c3.46-1.86,7.16-3.33,10-6.16l-.33-.41h0a2.92,2.92,0,0,1-.08-.6,2.92,2.92,0,0,0,.08.6l.33.41,2.76-1.83c1.12-.59,2.47-.79,3.25-1.94,2.28-1.8,4.35-4,6.9-5.28s4.24-3.48,6.61-4.84c2.83-1,5.61-2.1,7.22-4.9a23.39,23.39,0,0,0,2.41-1.46c3.07-2.38,7.78-2.93,8.7-7.73a13.39,13.39,0,0,0,3.86-1.47l.49,0c0,.36.32.69.61.43,2-1.82,4.7-2,7.22-3l-1.49-.75c0,1.32-.8,1.32-1.62.85a5.71,5.71,0,0,0-2.37-.86c1.46-1.58,4.09-2.39,3.5-5.33,0,0,.42-.15.62-.27,1.91-1.09,3.68-2.31,4.2-4.68.1-.44,1.1-.64.42-1.32-.53-.53-1-.11-1.53.11-.93.4-2,1.1-2.31-.63l.55-.35,0,0h0c.83-1.2.59-1.55-.89-1.38a13,13,0,0,0-6,2.74c-1.28.64-2.59,1.22-3.82,1.92-4.44,2.54-9.51,4-13.28,7.68l-.77.28c-2,1.22-4.47,1.53-6.13,3.34l-.1,0c-.48.26-1.12.23-1.42.8-1.81,1-3.86,1.5-5.49,2.84-.13.09-.26.18-.38.28-1.36.2-1.88,1.44-2.77,2.23l-.12,0a2.79,2.79,0,0,0-1.82.92.6.6,0,0,0-.62.49l-.52.25h-.22l-.07.21-.12.1-2,.76c-1.36,1.06-3,1.66-4.21,3a1.8,1.8,0,0,0-1.5.67c-1.61,1-3.81,1.2-4.83,3.16-.64.5-1.59.57-2,1.44h0c-1.53,0-2.49,1.83-4.1,1.38,1.31-4.71,3.9-8.85,5.41-13.46.59-1.82,1.2-3.86,2.66-5.23a8,8,0,0,0,2.43-4.26l0,0a7.44,7.44,0,0,0,2.65-4c.21-.42.42-.84.64-1.25l.15,0,0-.16c.1-.16.19-.33.29-.5,1.12-.84.83-2.38,1.61-3.35,3.19-4,5-8.71,7.4-13.09l.24-.77a4.69,4.69,0,0,0,3.16-3.59c2.38-5,6.38-9,9.27-13.65l1.73-3.33h0c1.92-2,3.12-4.55,4.92-6.67,2.37-2.78,4-6.22,6.66-8.71,3.38-3.21,5.36-7.39,8.46-10.74l.31-.39.16-.07,0-.17.39-.14-.07-.12c.21-.23.41-.47.62-.71a.28.28,0,0,1,0-.25v0a.28.28,0,0,0,0,.25c2.28-.56,2.39-3.07,3.9-4.32a1.66,1.66,0,0,0,.94-1.19l-1,.89A2.17,2.17,0,0,0,103.74,29a2.17,2.17,0,0,1,1.67-1.22l1-.89.06-.08c.26,0,.4-.14.36-.42l.09-.13c1.62-1.73,3.82-2.82,5.29-4.72a20.85,20.85,0,0,1,6.3-5.59c3.8-2.38,6.48-5.94,9.13-9.44C129.33,4.37,128.45,2.88,125.78,2.74ZM91.47,103.23a.28.28,0,0,0,.24.1.28.28,0,0,1-.24-.1,1,1,0,0,1-.55-.15A1,1,0,0,0,91.47,103.23Zm2.71,3.12a1.41,1.41,0,0,1-.45-.07A1.41,1.41,0,0,0,94.18,106.35Zm2.29-.19a.93.93,0,0,0,.33.35A.86.86,0,0,1,96.47,106.16Zm-.14-.49h0l0,0h0Zm-1.72.62c.55-.13,1.08-.47,1.65-.63C95.69,105.82,95.16,106.16,94.61,106.29ZM104.71,93a1,1,0,0,0-.3,0A1,1,0,0,1,104.71,93ZM97.64,29h0l-.18.4Zm-9.89.88a1.43,1.43,0,0,0-.5-.23A1.43,1.43,0,0,1,87.75,29.9Zm0,1.1a.32.32,0,0,1-.23,0A.32.32,0,0,0,87.8,31Zm1.27,6ZM86.16,23.51a2.42,2.42,0,0,0,0,.39,2.42,2.42,0,0,1,0-.39c-.28-.18-.37-.36-.36-.54C85.79,23.15,85.88,23.33,86.16,23.51Zm-2.4,5.31a1.22,1.22,0,0,1,0,.27,1.22,1.22,0,0,0,0-.27l-.46-.23ZM71.9,49.36a1,1,0,0,0-.71-.26,5.4,5.4,0,0,1-.26-.84,5.4,5.4,0,0,0,.26.84A1,1,0,0,1,71.9,49.36Zm.25.71Zm15-29.73a2.23,2.23,0,0,1,0,.27q0,.41,0,.81,0-.41,0-.81A2.23,2.23,0,0,0,87.17,20.34Zm-1,1.72h0l-.48-.49Zm-3.34,6.36a2.6,2.6,0,0,0-1-.08,2.9,2.9,0,0,1,0,.73,1.25,1.25,0,0,1-.66,1,1.25,1.25,0,0,0,.66-1,2.9,2.9,0,0,0,0-.73A2.6,2.6,0,0,1,82.83,28.42ZM77,34.62c.56-1.6.05-4,2.9-3.87h0a1.45,1.45,0,0,0,.1.55,1.45,1.45,0,0,1-.1-.55c-2.85-.13-2.34,2.27-2.73,4h0L77,34.62s0,.08,0,.12c-.63-.08-1.33-.25-1.27.48C75.66,34.42,76.5,34.7,77,34.62Zm-1.86,2.1a5.14,5.14,0,0,1-1.54.29h0A5.14,5.14,0,0,0,75.13,36.72ZM70.72,40.9h0l-.47.48h0l.47-.48ZM67.07,56.06l0-.37h0Zm.82-6.57h0c-.16-.65.42-.53.72-.7C68.31,49,67.73,48.84,67.89,49.49ZM44.14,95a2.62,2.62,0,0,1,.49-1.41c0,.07-.15.33,0,.32a4.65,4.65,0,0,0,0,.63,2,2,0,0,0,.44,0,1,1,0,0,1,.24,0,1,1,0,0,0-.24,0,2,2,0,0,1-.44,0Zm.49-1.41a.67.67,0,0,1,0-.25A1.09,1.09,0,0,0,44.63,93.6Zm.37-.36a.1.1,0,0,1,0,.07S45,93.26,45,93.24Zm.1-7.63a5.63,5.63,0,0,0,.33,1A5.63,5.63,0,0,1,45.1,85.61Zm12.07,5.07h0L57,91.3C57.06,91.09,57.12,90.89,57.17,90.68Zm-4.38,2.08h0l.21-.38Zm1.75-20.15h0c0,.12,0,.24,0,.36Zm.76,22.6a.67.67,0,0,1,.18.2A.67.67,0,0,0,55.3,95.21Zm4.72-33c-.19-.33-.47-.66-.42-1h0C59.55,61.53,59.83,61.86,60,62.19Zm-1.67-.67c-.07.22-.13.45-.19.67s-.18.69-.26,1c.08-.34.17-.69.26-1S58.28,61.74,58.35,61.52Zm-.7.66h0Zm-4.18,1.94a9.61,9.61,0,0,1,2-.52,9.61,9.61,0,0,0-2,.52l-.15.44ZM27.15,136.51a2.73,2.73,0,0,1,.5-1.42A2.73,2.73,0,0,0,27.15,136.51Zm15-4a.39.39,0,0,1,0-.3,2.69,2.69,0,0,1-.71-1.27,2.69,2.69,0,0,0,.71,1.27A.39.39,0,0,0,42.18,132.53Zm-11-6.12c0-.16.06-.32.08-.48a6.51,6.51,0,0,1,1.44-.32,6.51,6.51,0,0,0-1.44.32l-.08.48.59.28ZM41,111.35a.63.63,0,0,0,.51-.25A.63.63,0,0,1,41,111.35Zm-8.18,19.78-.4-.18.4.18Zm-1.73-4.2h0l-.75,1.84Zm2,17.68c.06-.13.19-.29.15-.39,0,.1-.09.26-.15.39Zm3-14.53-.37-.08Zm-8.72.8c.73-1.57,1.39-1.69,2.68-1.5.37,1.75-.61,3.25-.91,4.88l-1,.38C27.88,133.43,26.56,132.72,27.41,130.88Zm-2.07,2.71a.68.68,0,0,1,.3.56,5.09,5.09,0,0,1-.63,1c-.1-.55-.18-.81-.2-1.08S25,133.47,25.34,133.59Zm-2-29.39c0,.15,0,.3,0,.46,0-.16,0-.31,0-.46ZM2.13,124A3.77,3.77,0,0,1,3,119.5,3.77,3.77,0,0,0,2.13,124c.64,0,1.49-.06,1.62.7C3.62,124,2.77,124,2.13,124ZM14,86.48a.75.75,0,0,1-.27.47A.78.78,0,0,0,14,86.48Zm-.83.66a.82.82,0,0,0,.52-.18.82.82,0,0,1-.52.18Zm-1.23,5.59c.13.06.3.2.39.16-.09,0-.26-.1-.39-.16Zm4.93,6.5-.4-.17.4.17Zm-.29,19a.87.87,0,0,1,.13-.19.87.87,0,0,0-.13.19l-.63.18ZM10.92,97.92a4.14,4.14,0,0,0,.64-.42A4.14,4.14,0,0,1,10.92,97.92ZM8.86,89.23h0v-1h0a.09.09,0,0,0-.12,0,.09.09,0,0,1,.12,0h0ZM9,90a.33.33,0,0,1-.18-.24A.33.33,0,0,0,9,90a1.59,1.59,0,0,0,.75.07A1.59,1.59,0,0,1,9,90Zm.35-1.73a3.56,3.56,0,0,1-.09-.73,3.56,3.56,0,0,0,.09.73ZM4,94.54H4s0,0,0,0S4,94.53,4,94.54ZM8.42,100c0-.21,0-.43-.05-.62h0c0-.64,0-1.28,0-1.92h0c0,.64,0,1.28,0,1.92C8.4,99.55,8.4,99.77,8.42,100Zm-.17,3.37L7.8,103Zm1.56,13.88a.85.85,0,0,0,.4.36.85.85,0,0,1-.4-.36Zm10.35.15h0c.13.06.29.19.39.15C20.45,117.57,20.29,117.44,20.16,117.38Zm1.08-29.25a.81.81,0,0,1-.18-.1.81.81,0,0,0,.18.1Zm-4.17-3.74c0,.12,0,.23,0,.35,0-.12,0-.23,0-.35ZM4,92.6a8.12,8.12,0,0,0-.42,1,8.12,8.12,0,0,1,.42-1v0Zm47.85,33.34h0Zm13-9.74a1.06,1.06,0,0,1,.67.28A1.06,1.06,0,0,0,64.84,116.2Zm11.46-6.71A2.18,2.18,0,0,1,76,109h0A2.18,2.18,0,0,0,76.3,109.49Zm.2-1.41Zm1.16,12a1.77,1.77,0,0,1,.27-.64A1.77,1.77,0,0,0,77.66,120Zm1.75-13v0Zm-15.48,9.2h-.47a2.47,2.47,0,0,1-.51.39,2.47,2.47,0,0,0,.51-.39ZM43.65,96h0c0,.16,0,.32,0,.48h0A10.6,10.6,0,0,0,43,99.85a10.6,10.6,0,0,1,.68-3.39C43.66,96.3,43.65,96.14,43.65,96Zm11.68,1.19h0a1.66,1.66,0,0,1,0-.22h1.39A2.79,2.79,0,0,0,55.33,97.17ZM65.41,49.11l-.49.49h0v0h0l.49-.49a4.3,4.3,0,0,0,1.23-.36A4.3,4.3,0,0,1,65.41,49.11ZM72.16,52Z"/>',
      '<path class="cls-1" d="M104.07,106.13l0,0v-.07Z"/><path class="cls-1" d="M104.07,106.13l0,0-.08,0Z"/>',
      '<path class="cls-1" d="M103.5,105.57a.49.49,0,0,0,.53.49l-.39-.65C103.59,105.47,103.5,105.52,103.5,105.57Z"/><path class="cls-1" d="M44.61,94.05a1,1,0,0,0-.47,1l.5-.46Z"/></svg>'
    ].join('\n');

    var svgWidth = 0,
      svgHeight = 0;

    if ($(window).width() >= 1500) {
      svgWidth = 78;
      svgHeight = 104;
    } else if ($(window).width() >= 1200) {
      // svgWidth = 27.5;
      // svgHeight = 66;
      svgWidth = 75;
      svgHeight = 100;
    } else if ($(window).width() >= 992) {
      svgWidth = 72;
      svgHeight = 96;
    } else if ($(window).width() >= 768) {
      svgWidth = 70;
      svgHeight = 93.5;
    } else if ($(window).width() >= 576) {
      svgWidth = 67;
      svgHeight = 89;
    } else {
      // svgWidth = 17.5;
      // svgHeight = 42;
      svgWidth = 65;
      svgHeight = 86;
    }

    // create marker
    var marker = new google.maps.Marker({
      position: latlng,
      map: map,
      icon: {
        url: 'data:image/svg+xml;charset=UTF-8,' + encodeURIComponent(template),
        scaledSize: new google.maps.Size(svgWidth, svgHeight),
        anchor: new google.maps.Point(10,svgHeight)
      }
    });

    // add to array
    map.markers.push(marker);

    // if marker contains HTML, add it to an infoWindow
    if ($marker.html()) {
      // create info window
      var infowindow = new google.maps.InfoWindow({
        content: $marker.html()
      });

      // show info window when marker is clicked
      google.maps.event.addListener(marker, 'click', function() {
        infowindow.open(map, marker);
      });
    }
  }

  /*
  *  center_map
  *
  *  This function will center the map, showing all markers attached to this map
  *
  *  @type	function
  *  @date	8/11/2013
  *  @since	4.3.0
  *
  *  @param	map (Google Map object)
  *  @return	n/a
  */

  function center_map(map) {
    // vars
    var bounds = new google.maps.LatLngBounds();

    // loop through all markers and create bounds
    $.each(map.markers, function(i, marker) {
      var latlng = new google.maps.LatLng(
        marker.position.lat(),
        marker.position.lng()
      );

      bounds.extend(latlng);
    });

    // only 1 marker?
    if (map.markers.length == 1) {
      // set center of map
      map.setCenter(bounds.getCenter());
      map.setZoom(15);
    } else {
      // fit to bounds
      map.fitBounds(bounds);
    }
  }

  /*
  *  document ready
  *
  *  This function will render each map when the document is ready (page has loaded)
  *
  *  @type	function
  *  @date	8/11/2013
  *  @since	5.0.0
  *
  *  @param	n/a
  *  @return	n/a
  */

  $(document).ready(function() {
    $('.acf-map').each(function() {
      render_map($(this));
    });
  });
})(jQuery);
